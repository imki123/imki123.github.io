<!DOCTYPE html><html data-react-helmet="lang" lang="en_US"><head><meta charset="utf-8"><link href="/images/imcat_64.png" rel="icon"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="#000000" name="theme-color"><meta content="ì„ê¸°ì˜ ì½”ë”© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤ ğŸ˜„" name="description"><meta content="/images/imcat_800x400.png" property="image"><meta content="/images/imcat_800x400.png" property="og:image"><meta content="HZicODInbBKemFyMPNAa0hZFqxXrvctIKQjKNGjc1g8" name="google-site-verification"><link href="/images/imcat.png" rel="apple-touch-icon"><link href="/styles/atom-one-dark.css" rel="stylesheet"><link href="/styles/index.css" rel="stylesheet"><script src="/lib/highlight.pack.js"></script><script src="/lib/naveridlogin_js_sdk_2.0.0.js"></script><script src="/lib/kakao.min.js"></script><meta content="profile email" name="google-signin-scope"><meta content="605411712139-eb3qqicskmkal2i9u26ppdhoq2jt0bd8.apps.googleusercontent.com" name="google-signin-client_id"><link href="/manifest.json" rel="manifest"><title>koa ëª©ë¡</title><script type="text/javascript">!function(i){if(i.search){var a={};i.search.slice(1).split("&").forEach((function(i){var l=i.split("=");a[l[0]]=l.slice(1).join("=").replace(/~and~/g,"&")})),void 0!==a.p&&window.history.replaceState(null,null,i.pathname.slice(0,-1)+(a.p||"")+(a.q?"?"+a.q:"")+i.hash)}}(window.location)</script><link href="/static/css/2.3c515868.chunk.css" rel="stylesheet"><link href="/static/css/main.da20d35e.chunk.css" rel="stylesheet"><link href="https://static.nid.naver.com" rel="preconnect"><style data-jss="" data-meta="MuiSvgIcon">.MuiSvgIcon-root{fill:currentColor;width:1em;height:1em;display:inline-block;font-size:1.5rem;transition:fill .2s cubic-bezier(.4,0,.2,1) 0s;flex-shrink:0;user-select:none}.MuiSvgIcon-colorPrimary{color:#3f51b5}.MuiSvgIcon-colorSecondary{color:#f50057}.MuiSvgIcon-colorAction{color:rgba(0,0,0,.54)}.MuiSvgIcon-colorError{color:#f44336}.MuiSvgIcon-colorDisabled{color:rgba(0,0,0,.26)}.MuiSvgIcon-fontSizeInherit{font-size:inherit}.MuiSvgIcon-fontSizeSmall{font-size:1.25rem}.MuiSvgIcon-fontSizeLarge{font-size:2.1875rem}</style><link href="/images/imcat_800x400.png" rel="image_src" data-react-helmet="true"><link href="https://imki123.github.io/undefined" rel="canonical" data-react-helmet="true"><meta content="/images/imcat_800x400.png" data-react-helmet="true" itemprop="image"><meta content="/images/imcat_800x400.png" data-react-helmet="true" property="og:image"><meta content="1200" data-react-helmet="true" property="og:image:width"><meta content="630" data-react-helmet="true" property="og:image:height"><meta content="/images/imcat_800x400.png" data-react-helmet="true" name="twitter:image"><meta content="YOUR WEB SITE" data-react-helmet="true" property="og:site_name"><meta content="koa ëª©ë¡" data-react-helmet="true" property="og:title"><meta content="https://imki123.github.io/undefined" data-react-helmet="true" property="og:url"><meta content="" data-react-helmet="true" property="og:locale"><meta content="website" data-react-helmet="true" property="og:type"><meta content="YOUR WEB SITE" data-react-helmet="true" property="fb:pages"><meta content="summary_large_image" data-react-helmet="true" name="twitter:card"><meta content="koa ëª©ë¡" data-react-helmet="true" name="twitter:title"><meta content="@YOURWEBSITE" data-react-helmet="true" name="twitter:site"><link href="https://blog-imki123-backend.herokuapp.com" rel="preconnect"><meta content="koa ëª©ë¡  CORS ì„¤ì • ì²´í—˜ê¸° (Koa, fetch, axios) Koaì—ì„œ ì‚¬ìš©ë˜ëŠ” status code" data-react-helmet="true" name="description"><meta content="koa ëª©ë¡  CORS ì„¤ì • ì²´í—˜ê¸° (Koa, fetch, axios) Koaì—ì„œ ì‚¬ìš©ë˜ëŠ” status code" data-react-helmet="true" property="og:description"><meta content="koa ëª©ë¡  CORS ì„¤ì • ì²´í—˜ê¸° (Koa, fetch, axios) Koaì—ì„œ ì‚¬ìš©ë˜ëŠ” status code" data-react-helmet="true" name="twitter:description"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><script>if("ReactSnap"!==navigator.userAgent){let t=document.createElement("script");t.setAttribute("src","https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"),t.setAttribute("data-ad-client","ca-pub-3156014367299473"),document.body.appendChild(t)}</script><input class="hidden" id="userinfo"><div id="naverIdLogin" class="hidden"><a href="#" id="naverIdLogin_loginButton"><img src="https://static.nid.naver.com/oauth/big_g.PNG?version=js-2.0.0" height="60"></a></div><div id="naverIdLogout" class="hidden" onclick="naverIdLogout()"></div><script type="text/javascript">let callBackUrl;callBackUrl=window.location.href.indexOf("localhost")>-1?"http://localhost:3000/login":"https://imki123.github.io/login";var naverLogin=new naver.LoginWithNaverId({clientId:"kjVk1u480gzQO_XLX_hp",callbackUrl:callBackUrl,isPopup:!1,loginButton:{color:"green",type:3,height:60}});function naverIdLogout(){naverLogin.logout();const n=window.open("https://nid.naver.com/nidlogin.logout");setTimeout((function(){n.close()}),1)}naverLogin.init(),window.addEventListener("load",(function(){naverLogin.getLoginStatus((function(n){if(n){let n=naverLogin.user;n.host="naver";const o=document.querySelector("#userinfo");o&&(o.value=JSON.stringify(n))}}))}))</script><div id="kakaoLogin" class="hidden" onclick="kakaoLogin()"></div><div id="kakaoLogout" class="hidden" onclick="kakaoLogout()"></div><script>function kakaoLogin(){Kakao.Auth.login({success:function(o){Kakao.API.request({url:"/v2/user/me",success:function(o){let a=o.kakao_account;a.host="kakao";const n=document.querySelector("#userinfo");n&&(n.value=JSON.stringify(a))},fail:function(o){}})},fail:function(o){}})}function kakaoLogout(){Kakao.Auth.getAccessToken()&&(Kakao.API.request({url:"/v1/user/unlink",success:function(o){},fail:function(o){console.log(o)}}),Kakao.Auth.setAccessToken(void 0))}Kakao.init("0d74caaceac5f0f14c0d6a667a9dbdee")</script><div id="googleLogin"></div><div id="googleLogout" onclick="signOut()"></div><script>if("ReactSnap"!==navigator.userAgent){let e=document.createElement("script");e.setAttribute("src","https://apis.google.com/js/platform.js"),e.setAttribute("async",!0),e.setAttribute("defer",!0),document.body.appendChild(e);let t=document.querySelector("#googleLogin");t&&(t.innerHTML='<div class="g-signin2 hidden" data-onsuccess="onSignIn" data-theme="dark"></div>')}</script><script>function onSignIn(e){var t=e.getBasicProfile();let n={name:t.getName(),email:t.getEmail(),imageUrl:t.getImageUrl(),host:"google"};const i=document.querySelector("#userinfo");i&&(i.value=JSON.stringify(n));e.getAuthResponse().id_token}function signOut(){var e=gapi.auth2.getAuthInstance();e.signOut().then((function(){})),e.disconnect().then(()=>{})}</script><div id="root"><div id="app"><div id="headerWrapper"><div id="header"><div class="menu hover"><svg aria-hidden="true" class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></div><a href="/"><div id="title" class="hover"><img src="/images/imcat_64.png" alt="logo" id="logo">ì„ê¸°ì˜ ì½”ë”© ë¸”ë¡œê·¸ ğŸ˜„</div></a><div class="hover"><img src="/images/noavatar.png" alt="PROFILE" class="profile"></div></div></div><div id="settingWrapper"><div id="setting"><div id="settingListWrapper"><a href="/login" class="settingList">ë¡œê·¸ì¸</a><a href="/register" class="settingList">íšŒì›ê°€ì…</a></div></div></div><div id="body"><div id="guideBack"><div id="guideWrapper" class="slideMenu"><div id="avatar"><img src="/images/avatar.png" alt="avatar" title="Hello ğŸ˜„"><div id="name">Im kiyoung</div><div id="nickName">imki123</div><div id="github"><a href="https://github.com/imki123"><img src="/images/GitHub-Mark-32px.png" alt="github"> <span>https://github.com/imki123</span></a></div><div id="introduction">A web programmer who dreams of becoming a wise developer.</div></div><div class="menus"><div><a href="/" class="list"><span class="menuName">Home</span><span class="menuOptions"><span class="menuCnt">1</span><span class="menuExpandIcon"></span></span></a></div><div><a href="/tags/programming" class="list"><span class="menuName">Programming</span><span class="menuOptions"><span class="menuCnt">11</span><span class="menuExpandIcon"><svg aria-hidden="true" class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></span></span></a><a href="/tags/css" class="list subList"><span class="menuName">Css</span><span class="menuOptions"><span class="menuCnt">2</span></span></a><a href="/tags/github" class="list subList"><span class="menuName">Github</span><span class="menuOptions"><span class="menuCnt">1</span></span></a><a href="/tags/javascript" class="list subList"><span class="menuName">Javascript</span><span class="menuOptions"><span class="menuCnt">3</span></span></a><a href="/tags/koa" class="list subList activeList" aria-current="page"><span class="menuName">Koa</span><span class="menuOptions"><span class="menuCnt">2</span></span></a><a href="/tags/react" class="list subList"><span class="menuName">React</span><span class="menuOptions"><span class="menuCnt">2</span></span></a><a href="/tags/react-native" class="list subList"><span class="menuName">React-native</span><span class="menuOptions"><span class="menuCnt">1</span></span></a></div><div><a href="/tags/article" class="list"><span class="menuName">Article</span><span class="menuOptions"><span class="menuCnt">3</span><span class="menuExpandIcon"><svg aria-hidden="true" class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></span></span></a><a href="/tags/current" class="list subList"><span class="menuName">Current</span><span class="menuOptions"><span class="menuCnt">2</span></span></a><a href="/tags/play" class="list subList"><span class="menuName">Play</span><span class="menuOptions"><span class="menuCnt">1</span></span></a></div></div><div class="menus"><a href="https://imki123.github.io/catbook" class="list"><div class="menuLink"><div><img src="/images/catbook_64.png" alt="catbook">Catbook</div><svg aria-hidden="true" class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24"><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></div></a></div></div></div><div id="content" class="slideMenu"><div id="scrollFAB" class="hover FAB"><svg aria-hidden="true" class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24"><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"></path></svg></div><div id="backFAB" class="hover FAB"><svg aria-hidden="true" class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg></div><div id="menuFAB" class="hover FAB"><svg aria-hidden="true" class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></div><div id="loading" style="display:none"><img src="/images/loading.gif" alt="Loading"></div><div class="postListWrapper"><div class="postListTitle">Koa ëª©ë¡</div><a href="/posts/20"><div class="postList no-drag"><div class="postListTags"><span class="postTags">Tag : programming, koa</span><span class="postDate">75, 2020-09-21</span></div><div class="postListHeader"><div><span class="postId">2.</span><span class="postTitle">CORS ì„¤ì • ì²´í—˜ê¸° (Koa, fetch, axios)</span></div></div><div class="postBody">corsëŠ” ì–´ë µë‹¤. corsëŠ” Cross-Origin-Resource-Sharingì˜ ì¤€ë§ì´ë‹¤. ì¦‰, ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜ ê°„ì˜ ìì› ê³µìœ ë¥¼ ì°¨ë‹¨í•˜ê¸° ìœ„í•œ ì •ì±…ì´ë‹¤. ì–´ë–¤ ì›¹í˜ì´ì§€ì—ì„œ ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ìì›ì„ ê°€ì ¸ì˜¤ê³ ì í• ë•Œ, ë„ë©”ì¸ì´ ë‹¤ë¥¼ ê²½ìš° ì´ë¥¼ ì°¨ë‹¨í•˜ëŠ” ì •ì±…ì´ë‹¤. ë‚˜ê°™ì€ ê²½ìš°ëŠ” í”„ë¡ íŠ¸ì—ì„œ ë°±ì—”ë“œ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì•¼í•˜ëŠ”ë° ë‘˜ì˜ ë„ë©”ì¸ì´ ë‹¬ë¼ì„œ ì„¤ì •í•´ì¤¬ë‹¤. corsëŠ” ë‘êµ°ë°ì—ì„œ ì„¤ì •í•´ì•¼í•œë‹¤. ë°±ì—”ë“œ, í”„ë¡ íŠ¸ì—”ë“œ ë‘˜ë‹¤ì´ë‹¤. ë°±ì—”ë“œëŠ”Â  1. ì„œë²„í”„ë ˆì„ì›Œí¬ì— cors ì •ì±…ì„ ì„¤ì •í•œë‹¤. const app = Koa() app.cors({ origin: 'https:kiyoung.com',Â  credentials: true,Â  exposeHeaders: ['page-count'] }) ë“±ì„ ì„¤ì •í•´ì•¼í•œë‹¤. 2. ì„œë²„ì˜ https í”„ë¡œí† ì½œì„ ì„¤ì •í•œë‹¤. app.proxy = true koaì˜ ê²½ìš° proxyë¥¼ ì„¤ì •í•´ì¤˜ì•¼ https í”„ë¡œí† ì½œì´ ë™ì‘í•œë‹¤. 3. ì¿ í‚¤ë¥¼ set í•˜ê¸°ìœ„í•´ì„œëŠ” ì„œë²„ì˜ cookieOptionsë„ ì„¤ì •í•´ì¤˜ì•¼í•œë‹¤. const cookieOptions = { secure: true, //https í”„ë¡œí† ì½œ sameSite: 'none' } ë¡œì»¬ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ í• ë•ŒëŠ” http í”„ë¡œí† ì½œì´ë¯€ë¡œ secureë¥¼ falseë¡œ ë°”ê¿”ì£¼ì–´ì•¼í•œë‹¤. ì•ˆí•˜ë©´ errorê°€ ë°œìƒí•œë‹¤.. ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” ctx.request.protocolì„ ì¡°íšŒí•´ì„œ ê°„ë‹¨í•œ ë©”ì„œë“œë¥¼ ë§Œë“¤ì–´ ë¯¸ë“¤ì›¨ì–´ì— ì¶”ê°€í•´ì£¼ì. í”„ë¡ íŠ¸ì—”ë“œëŠ” ë°ì´í„°ë¥¼ ìš”ì²­í•  ë•ŒÂ credentials ì„¤ì •ì„ í¬í•¨í•˜ì—¬ ì „ì†¡í•´ì•¼í•œë‹¤. 1. axiosì˜ ê²½ìš° axios.post(url, { withCredentials: true }) ë¥¼ ì„¤ì •í•´ì•¼í•œë‹¤. 1. fetchì˜ ê²½ìš° fetch(url,{ method: 'POST', mode: 'cors', credentials: 'include' }) p.s) axios ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ cookie-setì„ í•  ê²½ìš° ì˜ ì•ˆëœë‹¤. ì•„ë¬´ë˜ë„ axiosì˜ ì˜¤ë¥˜ì¸ ê²ƒìœ¼ë¡œ ìƒê°ëœë‹¤. ê¸°ë³¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ fetchëŠ” ì˜ ì‘ë™í•œë‹¤. ê·¸ë˜ì„œ ëŒ€ë¶€ë¶„ axiosë¥¼ ì‚¬ìš©í•˜ê³  ctx.cookieë‚˜ ctx.stateë¥¼ ì¡°ì‘í•´ì•¼ í•˜ëŠ” ê²½ìš°ëŠ” fetchë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ë‘˜ ë‹¤ ì‚¬ìš©í•˜ë‹¤ë³´ë‹ˆ ë‘˜ ë‹¤ ê¹Œë¨¹ì§€ ì•Šì•„ì„œ ì¢‹ì€ ê²ƒ ê°™ê¸°ë„ í•˜ë‹¤. axiosë¥¼ ì¨ì„œ í¸í•˜ê²Œ í•˜ëŠ” ê²ƒë„ ì¢‹ì§€ë§Œ fetchë„ ì‚¬ìš©í•  ì¤„ ì•Œì•„ì•¼ í•˜ê² ì§€?</div></div></a><a href="/posts/18"><div class="postList no-drag"><div class="postListTags"><span class="postTags">Tag : programming, koa</span><span class="postDate">74, 2020-10-02</span></div><div class="postListHeader"><div><span class="postId">1.</span><span class="postTitle">Koaì—ì„œ ì‚¬ìš©ë˜ëŠ” status code</span></div></div><div class="postBody">100 "continue" 101 "switching protocols" 102 "processing" 200 "ok" 201 "created" 202 "accepted" 203 "non-authoritative information" 204 "no content" 205 "reset content" 206 "partial content" 207 "multi-status" 208 "already reported" 226 "im used" 300 "multiple choices" 301 "moved permanently" 302 "found" 303 "see other" 304 "not modified" 305 "use proxy" 307 "temporary redirect" 308 "permanent redirect" 400 "bad request" 401 "unauthorized" 402 "payment required" 403 "forbidden" 404 "not found" 405 "method not allowed" 406 "not acceptable" 407 "proxy authentication required" 408 "request timeout" 409 "conflict" 410 "gone" 411 "length required" 412 "precondition failed" 413 "payload too large" 414 "uri too long" 415 "unsupported media type" 416 "range not satisfiable" 417 "expectation failed" 418 "I'm a teapot" 422 "unprocessable entity" 423 "locked" 424 "failed dependency" 426 "upgrade required" 428 "precondition required" 429 "too many requests" 431 "request header fields too large" 500 "internal server error" 501 "not implemented" 502 "bad gateway" 503 "service unavailable" 504 "gateway timeout" 505 "http version not supported" 506 "variant also negotiates" 507 "insufficient storage" 508 "loop detected" 510 "not extended" 511 "network authentication required"</div></div></a><div class="paging"><a href="/tags/koa?page=1" class="activePage" aria-current="page" path="/tags/koa">1</a></div></div><textarea disabled id="fakeTextarea" style="height:0;width:464px"></textarea></div></div></div></div><script>!function(e){function r(r){for(var n,i,l=r[0],f=r[1],a=r[2],c=0,s=[];c<l.length;c++)i=l[c],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&s.push(o[i][0]),o[i]=0;for(n in f)Object.prototype.hasOwnProperty.call(f,n)&&(e[n]=f[n]);for(p&&p(r);s.length;)s.shift()();return u.push.apply(u,a||[]),t()}function t(){for(var e,r=0;r<u.length;r++){for(var t=u[r],n=!0,l=1;l<t.length;l++){var f=t[l];0!==o[f]&&(n=!1)}n&&(u.splice(r--,1),e=i(i.s=t[0]))}return e}var n={},o={1:0},u=[];function i(r){if(n[r])return n[r].exports;var t=n[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=n,i.d=function(e,r,t){i.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,r){if(1&r&&(e=i(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)i.d(t,n,function(r){return e[r]}.bind(null,n));return t},i.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(r,"a",r),r},i.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},i.p="/";var l=this.webpackJsonpblog_imki123=this.webpackJsonpblog_imki123||[],f=l.push.bind(l);l.push=r,l=l.slice();for(var a=0;a<l.length;a++)r(l[a]);var p=f;t()}([])</script><script src="/static/js/2.e1b1b6d0.chunk.js"></script><script src="/static/js/main.41890311.chunk.js"></script></body></html>